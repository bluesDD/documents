---
Title: ホストメトリック・サービスメトリック監視ルールで最大試行回数を設定できるようになりました　ほか
Category:
- weekly
Date: 2017-12-08T11:48:50+09:00
URL: https://mackerel.io/ja/blog/entry/weekly/20171208
EditURL: https://blog.hatena.ne.jp/mackerelio/mackerelio-ja.hatenablog.mackerel.io/atom/entry/8599973812324669776
---

先週もお伝えした Mackerel のアドベントカレンダーですが、ユーザーのみなさまのおかげで、全ての枠が埋まりしました！



[https://qiita.com/advent-calendar/2017/mackerel:embed:cite]



ありがとうございます！

また、CRE の id:Soudai:detail が頑張るこちらのアドベントカレンダーも、開始から今日まで一つも落とすことなく、また非常に有益な情報・知見が満載のブログが毎日公開され、継続しています。



[https://qiita.com/advent-calendar/2017/mackerel-plugins:embed:cite]



クリスマスまでの道のりといっしょに、これらのアドベントカレンダーを楽しんでもらえたらと思います。

それでは、今週のアップデートです。


## グラフボードにカスタマイズグラフ（式グラフ）を追加できるようになりました

任意のロールグラフ・サービスメトリックグラフを好きなように配置でき、インタラクティブに操作が可能な「グラフボード」、みなさまご活用いただいているでしょうか。



[https://mackerel.io/ja/docs/entry/howto/graphboard:embed:cite]



今週のアップデートにより、このグラフボードに追加できるグラフの種類が増え、カスタマイズグラフ（式グラフ）を追加できるようになりました！

[f:id:mackerelio:20171208074156p:plain]

- あるサーバの、先週の負荷と今週の負荷の様子を重ね合わせてひとつのグラフとして表示する
- あるロールに属するサーバの負荷の値のうち、最大値／平均値／最小値を計算したものをグラフ表示する

といったようなことが関数式の記述をすることで実現できる、非常に便利なカスタマイズグラフ。その活用が、今までよりもさらにしやすくなると思います。

カスタマイズグラフは実験的機能となっています。詳しくは以下のヘルプページを参照してください。


[https://mackerel.io/ja/docs/entry/advanced/experimental-features-config:embed:cite]




[https://mackerel.io/ja/docs/entry/advanced/advanced-graph:embed:cite]




## ホストメトリック・サービスメトリック監視ルールで最大試行回数を設定できるようになりました

[f:id:mackerelio:20171208073940p:plain]

上の画像のとおり、ホストメトリック・サービスメトリック監視ルールで「アラート発生までの最大試行回数」を設定できるようになりました。

今までは、「n分の平均値の監視」という、「平均値監視」のみをサポートしていました。この設定をもちいて、「閾値 `5` を継続して越えるようなときにアラート発報させたい」といったときに、

- 閾値として `5`
- 3分の平均値を監視

といった設定をしていた場合、`7` → `5` → `6`といったような経過をたどった場合（この場合の「3分の平均値」は `6`）だけでなく、 `1` → `16` → `1` といったような経過をたどった場合（この場合の「3分の平均値」も `6`）でもアラート発報につながり、必ずしも意図したケースだけでアラートを受け取ることが難しい場合がありました。

今回追加した「アラート発生までの最大試行回数」を用いることで、上記のようなケースでも切り分けることができるようになります。監視対象のメトリックに応じて、「n分の平均値の監視」と使い分けてもらえたらと思います。


## 年末年始期間中におけるサポート窓口対応の休業のお知らせ
Mackerel にログインしている状態でヘッダー右上に表示されている「サポートチームへ連絡」からのお問い合わせや、support@mackerel.io 宛へのお問い合わせへの対応について、以下の年末年始期間中はお休みさせていただきます。

<b>年末年始休業期間：2017年12月28日（木）〜2018年1月3日（水）</b>

この期間中にいただいたお問い合わせについては、2018年1月4日（木）以降に順次対応させていただきます。


年末年始に向けてのサーバー監視設定の見直しなどはぜひお早めに実施していただき、そこでのご不明点は早めにお問い合わせください！
